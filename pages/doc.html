<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>計算で図形を描く</title>

    <!-- Bootstrap -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/prism.css" rel="stylesheet" />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
<body class="container pt-5 pb-5">
    <h1>計算で図形を描く</h1>
    <p>
      前回は初めてプログラムで絵を描いたわけですが、図形の位置も色もすべて数値を手作業で入力したので、お絵かきソフトで描くよりもむしろ大変だったと思います。
      今回は、図形をたくさん一気に描くなど、プログラムらしい図形の描き方をやっていきましょう。
    </p>
    <h2>目次</h2>
    <ul>
        <li><a href="#variable">変数 (variable)</a></li>
        <li><a href="#constant">定数 (constant)</a></li>
        <li><a href="#operation">演算</a></li>
        <li><a href="#loop">繰り返し (loop)</a></li>
        <li><a href="#conditional">条件分岐 (conditional expression)</a></li>
        <li><a href="#practice">演習問題</a></li>
    </ul>

    <h2 id="variable">変数</h2>
    <p>
      前回の例ではプログラム中に多くの数値が出てきました。
      後からプログラムを見返すと「この数値なんだっけ？」となることはよくあります。
      また、ユーザの操作などに応じて値を変化させて、描画する図形を変化させたいときなどもよくあります。
      値に名前を付ける機能「<dfn>変数</dfn>」を使うと便利です。
      物理なんかでよく出てくる「速度を<var>v</var>とする」と同じノリです。
      プログラムは自分でつけた変数名を使って記述して、そこに色々な値を代入するというわけです。
    </p>
    <p>
      具体例で見てみましょう。以下のプログラムでは2つの同じ大きさの正方形を描画しています。
      正方形の一辺の長さを<var>s</var>という名前の変数とすることで、一辺の長さはどれも同じだということがわかりやすくなっています。
      後から長さを変更したくなったときにも代入する部分だけを変更すれば済みますので便利です。
    </p>
<pre><code class="language-javascript">function setup() {
  createCanvas(100,100);
  let s;  // s という名前の変数を宣言する
  s = 20; // s に 20 を代入する
  rect(10, 10, s, s);
  rect(90, 90, s, s);
}
</code></pre>
    <p>
      変数を利用するための文法は以下の通りです。変数は使用する前に必ず宣言することが必要なので気を付けてください。
    </p>

<pre><code class="language-javascript">let 変数名;  // 変数の宣言
let x, y, z; // カンマ区切りで複数まとめて宣言してもOK

変数名 = 値;     // 変数に値を代入
let 変数名 = 値; // 宣言と代入を同時にしてもOK
</code></pre>

    <p>
      変数名は自由に決めることができますので、速度なら <var>v</var> など、イメージしやすい名前を付けます。
      ただし、 <code class="language-javascript">let</code> 等の予約語（文法として使用される語）を変数名にすることはできません。
      また、数字から始める名前にすることもできません。
      漢字やひらがな等の日本語も使用できますが、あまりお勧めしません。
    </p>

    <ul>
      <li><code class="language-javascript">let 1x, let, for;</code> こういう変数名は使えない</li>
      <li><code class="language-javascript">let x1, x2;</code> 数字から始まるのはだめだけど、数字は使ってもいい。わりとよく使う。</li>
      <li><code class="language-javascript">let let1, for2;</code> こういう変数名は使えるけど、使わない方がいいと思います。</li>
    </ul>

    <h2 id="constant">定数</h2>
    <p>
      「<dfn>定数</dfn>」もあります。変数との違いは、再代入できないことです。
      定数も変数と同じように宣言してから使用します。
    </p>
<pre><code class="language-javascript">const 定数名 = 値;
定数名 = 新しい値; // 再代入しようとするとエラー
</code></pre>

    <p>変更する予定がない値は定数として宣言しておくと、誤って変更しようとしたときにエラーが出て気付くことができます。命名規則は変数と同じです。</p>


    <h2 id="operation" class="mt-5">演算</h2>
    <p>
      足し算・掛け算・割り算など揃っています。
      プログラム中で本格に使う前にデベロッパーツールのコンソール上で一通り使ってみましょう。
      <a href="Programming-Tools.html#browser">デベロッパーツールの使い方は覚えていますか？</a>
      ちなみにコンソールでも変数や定数を定義して使うことができます。
    </p>

    <img src="./images/operations_math.png" class="m-3" width="640" />

　　<p>
      以下のプログラム例のように、計算結果を変数に代入することもできます。
      同じ <code class="language-javascript">point(x, 46)</code> という命令でも、
      x の値が変化しているので実行結果が変わります。
    </p>

<pre><code class="language-javascript">function setup() {
  let x = 21;
  point(x, 46);
  x = x - 2;     // x - 2 を計算して、その結果を x に再代入するという意味になります。つまり x の値が 2 減ります。
  point(x, 46);
  x = x + 9;     // 「x と x + 9 が等しいって？そんなバカな！」って最初は戸惑うと思います。
  point(x, 46);
}
</code></pre>

    <h3 class="mt-5">条件の演算</h3>
    <p>
      条件によってプログラムの動作を変えたいことがあります。たとえば、「奇数行と偶数行で色を変えて縞模様にする」「敵に触れた回数が3と等しいときだけゲームオーバーの処理をする」などです。
      こういった処理は、敵に触れた回数など必要な値を変数に代入しておき、その値が条件を満たすかどうかを調べます。
    </p>
    <p>条件の演算もコンソールを開いて一通り使ってみましょう。</p>

    <img src="./images/operations_cond.png" class="m-3" width="640" />

    <p>
      コンソールの出力を見たらわかるように、条件演算の結果は <code>true</code> (条件成立) または <code>false</code> (条件不成立) のどちらかになります。
      変数に代入するときは <code>=</code> で、等しいか調べるときは <code>==</code> (イコール2つ) で間違えやすいので注意しましょう。
      以上・以下・等しくない、どれも2文字ですが、イコールは2文字目です。
    </p>

    <p>複数の条件を組み合わせた条件を作ることもできます。たとえば、数値がある範囲内かどうかを調べるだけでも「～以上」「～未満」というように2つの条件を組み合わせる必要があります。</p>
    <img src="./images/operations_cond2.png" class="m-3" width="640" />

    <p>
      <code>A && B</code> は「AかつB」の意味で A と B がともに <code>true</code> の場合にのみ <code>true</code> になります。
      <code>A || B</code> は「AまたはB」の意味で A と B がともに <code>false</code> の場合にのみ <code>false</code> になります。
      <u><code>1 < x < 3</code> というようなまとめた書き方はできない</u>ので注意しましょう。
      ちなみに <code>&</code> や <code>|</code> というように1文字だと異なる演算になりますのでこれも注意しましょう。
    </p>


    <h2 id="loop" class="mt-5">繰り返し <span class="badge badge-pill badge-info">section2-1</span></h2>
    <p>
      条件を利用するケースのひとつが繰り返しです。似た処理を何回か繰り返し実行してほしいとき、いつまで繰り返すのかを条件として記述します。
      繰り返しには <code class="language-javascript">while</code> と <code class="language-javascript">for</code> の2種類があります。
    </p>

    <h3>while 文</h3>
    <p>while は次のようなとてもシンプルな文法です。</p>
<pre><code class="language-javascript">while(繰り返しを続ける条件){
  // 繰り返したい処理
}
</code></pre>
    <p>たとえば次のように使います。四角を繰り返し描いて、端まで来たら終わりというプログラムです。</p>
<pre><code class="language-javascript">function setup() {
  createCanvas(100,100);
  fill(0);
  let x = 0;
  while(x < 100){       // 座標が描画範囲内であれば続ける
    rect(x, x, 20, 20);
    x = x + 20;         // 繰り返し1回ごとに場所を動かす
  }
}
</code></pre>
    <p>
      <code class="language-javascript">x = x + 20</code> を忘れたり、条件を書き間違えたりすると永遠に繰り返しが終わらないプログラムができあがります。
      画面には何も表示されません。しかし、ずっと繰り返し演算をしていますのでCPUの温度が上昇してファンが音を立てて回り始めたりするかもしれません。
      冬場なら緊急時の暖房代わりになるでしょう。
      <u>俗に「無限ループ」と呼ばれる現象です。</u>
      試しにわざとやってみたい人は、やってみた後、プログラムを正常に書き直すのをお忘れなく。
    </p>

    <h3>for 文</h3>
    <p>
      繰り返しのもう一つの書き方が for 文です。
      for 文はシンプルな繰り返しをコンパクトに書くことができるのが特徴です。
    </p>
<pre><code class="language-javascript">for(繰り返し前にする処理; 繰り返しを続ける条件; 繰り返し毎にする処理){
  // 繰り返したい処理
}
</code></pre>
    <p>
      先ほどと同じプログラムを for 文を使って書き直したものが次になります。繰り返しで変化する変数 x に関する記述が一か所にまとまってコンパクトになりました。
      「x は最初 0 で、一回ごとに 20 増えて、100 以上になったら終了」とまとまっています。
    </p>
<pre><code class="language-javascript">function setup() {
  createCanvas(100,100);
  fill(0);
  for(let x = 0; x < 100; x = x + 20){ // 繰り返しで変化する変数 x に関する記述
    rect(x, x, 20, 20);
  }
}
</code></pre>
    <p>
      while, for はどちらを使ってもよいのですが、シンプルな繰り返しには for 文を用いる、くらいの使い分けがよいでしょう。
      for 文を使う方が便利な代表格は「N回繰り返す」処理です。
      たとえば先ほどの例も「四角形を5回描く」と考えて書くと次のようになります。
      <code>i++</code> は「i を 1 増やす」という意味の省略記法です。
      N回繰り返すは <code class="language-javascript">for(let i = 0; i < N; i++){...}</code>　と書くというのは慣用句のように頻出なので、何回かやるうちに覚えてしまいましょう。
    </p>
<pre><code class="language-javascript">function setup() {
  createCanvas(100,100);
  fill(0);
  for(let i = 0; i < 5; i++){
    rect(i * 20, i * 20, 20, 20);
  }
}
</code></pre>

<div class="border rounded mt-5 ml-5 p-4">
  <h4>「変数の値をN増やす/減らす」の様々な書き方</h4>
  <p>
    変数値を増減させることは頻出するので、様々な省略記法が用意されています。
  </p>
<pre><code class="language-javascript">i = i + 1; // 普通の書き方
i += 1; // ちょっと短くした書き方
i -= 1;
i++;    // 1増やしたいとき専用の書き方
i--;    // 1減らしたいとき専用の書き方
</code></pre>  
  <p>
    そんな数文字をケチるために違う書き方を作らなくてもいいのに…と思うのはもっともです。
    自分で書くときはひとつだけ覚えておけばOKですが、他の人が書いたプログラムが読めるように、頭の片隅に入れておきましょう。
  </p>
</div>


  <h2 id="conditional" class="mt-5">条件分岐</h2>
  <p>繰り返しには慣れてきましたか？次は条件分岐の if 文です。
    条件が <code>true</code> か <code>false</code> かで処理を変えることができます。
    文法は以下の通りです。
  </p>
<pre><code class="language-javascript">if(条件){
  // 条件が true のときにする処理
}
else{
  // 条件が false のときにする処理
}
</code></pre>
  <p>条件が <code>false</code> の場合にしたい処理が特にないときは <code class="language-javascript">else{...}</code> は省略することができます。</p>

  <p>3つ以上に分岐することもできて、以下のように <code class="language-javascript">else if</code> を使って書きます。</p>
  <pre><code class="language-javascript">if(条件1){
  // 条件1が true のときにする処理
}
else if(条件2){
  // 条件1が false で、条件2 が true のときにする処理
}
else if(条件3){
  // 条件1, 2が false で、条件3 が true のときにする処理
}
...
else{
  // すべての条件が false のときにする処理
}
</code></pre>
  <p><code class="language-javascript">else if</code> を使わないで次のように書くと分岐の仕方が変わりますので注意しましょう。</p>
<pre><code class="language-javascript">if(条件1){
  // 条件1が true のときにする処理
}
if(条件2){
  // 条件2 が true のときにする処理（条件1の結果に関わらず)
}
else{
  // 条件2 が false のときにする処理 (条件1の結果に関わらず)
}
</code></pre>

  <h2>二重ループ <span class="badge badge-pill badge-info">section2-3</span></h2>
  <p>
    繰り返しの中にさらに繰り返しを書くということもできます。
    次の例では、「縦に10個、四角形を描く」という繰り返しを10回繰り返すことで二次元的に四角形を10 x 10 = 100個描いています。
  </p>
<pre><code class="language-javascript">for(let i = 0; i < 10; i++){
  for(let j = 0; j < 10; j++){
    console.log(i, j); // 補足： i,j の変化がわかりやすくなるように入れています
    rect(i * 10, j * 10, 5, 5);
  }
}
</code></pre>
  <p>
    コンソールの出力もあわせて確認するとどのように繰り返しているかがわかりやすいかと思います。
    <var>i</var>, <var>j</var> の2つの変数を使っていることに注意しましょう。
    <var>i</var> と書くべきところに <var>j</var> と書いてしまうバグをよくやらかします。
  </p>
  <p>
    このような繰り返しのことを「二重ループ」と呼びます。
    二次元に画面を埋めていくためによく使います。
    文法的には何重になってもOKですが、出てくるのは多くても三重ループくらいです。
  </p>

  <p>では練習として「偶数『行』の四角形の色を変える」「偶数『列』の四角形の色を変える」ように条件分岐を追加してみてましょう。</p>
  <p>できましたか？</p>

  <h2 id="practice" class="mt-5">演習問題</h2>
  <p>
    今回新しく学ぶ内容は以上です。
    反復練習で慣れるために練習問題をいくつか用意しました。
    お題を再現できるプログラムができた後も、もっとすっきり短いプログラムにできないか？と考えてみてください。
  </p>
  <h3>小手調べ <span class="badge badge-pill badge-info">section2-q1</span></h3>
  <img src="./images/circles.png" class="m-5" />
  <p>
    まずは小手調べです。内側に青い円が5つ、外側に赤い円が5つです。
    円を描くには <code class="language-javascript">ellipse(中心のx座標, 中心のy座標, 半径);</code> を使います。
    色を赤にするには <code class="language-javascript">stroke(255, 0, 0);</code>、青くするには <code class="language-javascript">stroke(0, 0, 255);</code> とします。
    内側の円から先に描くと後から描いた円に塗りつぶされてしまいますので、
    塗りつぶしをしないようにする <code class="language-javascript">noFill();</code> を事前にしておくか、外側の円から順に描くようにするかする必要があります。
  </p>

  <h3>チェッカー <span class="badge badge-pill badge-info">section2-q2</span></h3>
  <img src="./images/checker.png" class="m-5" />
  <p>二重ループと条件分岐を使う問題です。まずは格子模様だけを描いてみましょう。i行j列の色は「i+jが偶数か？」で分岐するとうまく塗分けられます。</p>

  <h3>ダーツ（難）<span class="badge badge-pill badge-info">section2-q3</span></h3>
  <img src="./images/darts.png" class="m-5" />
  <p>様々な描き方が考えられる問題です。私は関数 <code>arc</code> を使いました。</p>

  <h3>国旗（ものによっては難）<span class="badge badge-pill badge-info">section2-q4</span></h3>
  <p>
    国旗の中には繰り返しパターンがあるものが多いです。図形の個数が何かしらの意味を持っている場合もあります。
    国旗を再現するプログラムを描くことでそういったことも知ることができて一石二鳥ですね！
    （余談ですが、企業ロゴマークには繰り返しはあまり見られません。なぜでしょうね。）
  </p>
  <p>特別に好みがない人はこの辺りに挑戦してみては？</p>
  <ul>
    <li>ギリシャ</li>
    <li>バーレーン</li>
    <li>ボスニア・ヘルツェゴヴィナ</li>
    <li>アメリカ合衆国（星を描くのは少し難しいので円などで代用してもいいでしょう）</li>
    <li>国旗じゃないけどEU （難：三角関数を使います）</li>
  </ul>

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="./js/bootstrap.min.js"></script>
  <script src="./js/prism.js"></script>
  </body>
</html>
